import{c as l,j as e,r as j,a as I,R}from"./createLucideIcon.js";import{S as v,a as g,R as P}from"./search.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=l("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=l("BrainCircuit",[["path",{d:"M12 4.5a2.5 2.5 0 0 0-4.96-.46 2.5 2.5 0 0 0-1.98 3 2.5 2.5 0 0 0-1.32 4.24 3 3 0 0 0 .34 5.58 2.5 2.5 0 0 0 2.96 3.08 2.5 2.5 0 0 0 4.91.05L12 20V4.5Z",key:"ixwj2a"}],["path",{d:"M16 8V5c0-1.1.9-2 2-2",key:"13dx7u"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M20.5 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z",key:"1s25gz"}],["path",{d:"M16.5 13a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z",key:"127460"}],["path",{d:"M20.5 21a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z",key:"fys062"}],["path",{d:"M18.5 3a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z",key:"1vib61"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=l("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=l("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=l("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v3",key:"am10z3"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M5 17a3 3 0 1 0 0-6 3 3 0 0 0 0 6z",key:"ychnub"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=l("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=l("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=l("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=l("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=l("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),h=({title:t,icon:a,children:c})=>e.jsxs("section",{className:"mb-8",children:[e.jsxs("h2",{className:"text-sm font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[a&&e.jsx(a,{className:"w-4 h-4"}),t]}),c]}),i=({number:t,title:a,description:c,icon:o,highlight:y})=>e.jsxs("div",{className:`flex gap-3 p-2 rounded-md bg-white border border-slate-100 shadow-sm transition-transform hover:scale-[1.01] ${y?"bg-amber-50 border-amber-200":""}`,children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 text-xs font-semibold text-slate-500 bg-slate-100 rounded flex-shrink-0",children:t}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(o,{className:"w-4 h-4 text-slate-600"}),e.jsx("div",{className:"text-sm font-medium text-slate-700",children:a})]}),c&&e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:c})]})]}),D=({saved:t,total:a,attempts:c})=>e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 last:border-b-0",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Сохранено ответов:"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:t})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 last:border-b-0",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Вопросов в базе:"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:a})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Всего попыток:"}),e.jsx("span",{className:"text-base font-semibold text-slate-900",children:c})]})]})}),G=()=>{const[t,a]=j.useState({saved:0,total:0,attempts:0}),[c,o]=j.useState("Проверка соединения...");j.useEffect(()=>{let d=!0;const s=setTimeout(()=>{if(d)try{y().catch(r=>{d&&(console.error("Failed to load statistics:",r),a({saved:0,total:0,attempts:0}))}),L().catch(r=>{d&&(console.error("Failed to load API settings:",r),o("❌ Ошибка подключения"))})}catch(r){d&&console.error("Error in useEffect:",r)}},100);return()=>{d=!1,clearTimeout(s)}},[]);const y=async function(){try{if(typeof window>"u"){console.warn("[loadStatistics] window is undefined"),a({saved:0,total:0,attempts:0});return}if(typeof chrome>"u"){console.warn("[loadStatistics] chrome is undefined"),a({saved:0,total:0,attempts:0});return}if(!chrome.storage){console.warn("[loadStatistics] chrome.storage is not available"),a({saved:0,total:0,attempts:0});return}if(!chrome.storage.local||!chrome.storage.sync){console.warn("[loadStatistics] chrome.storage.local or sync is not available"),a({saved:0,total:0,attempts:0});return}let s={};try{s=await chrome.storage.local.get(null)||{}}catch(n){console.warn("[loadStatistics] Error reading local storage:",n),s={}}let r=0;if(s&&typeof s=="object"&&s!==null)try{const n=Object.keys(s);for(let x=0;x<n.length;x++){const m=n[x];m&&typeof m=="string"&&m.startsWith("answer_")&&r++}}catch(n){console.warn("[loadStatistics] Error counting saved answers:",n)}let k=0,S=0;if(s&&typeof s=="object"&&s!==null)try{const n=Object.keys(s),x=new Set;for(let m=0;m<n.length;m++){const p=n[m];if(p&&typeof p=="string"&&p.startsWith("stats_")){const z=p.replace("stats_","");x.add(z);const u=s[p];if(typeof u=="object"&&u!==null&&u!==void 0&&"totalAttempts"in u){const f=u.totalAttempts;typeof f=="number"&&!isNaN(f)&&isFinite(f)&&f>=0&&(S+=f)}}}k=x.size}catch(n){console.warn("[loadStatistics] Error counting questions:",n)}a({saved:r,total:k,attempts:S})}catch(s){console.error("[loadStatistics] Unexpected error:",s),a({saved:0,total:0,attempts:0})}},L=async function(){try{if(typeof window>"u"||typeof chrome>"u"){console.warn("Chrome API not available - window or chrome is undefined"),o("⚠️ API недоступен");return}if(!chrome.runtime||!chrome.runtime.sendMessage){console.warn("Chrome runtime API not available"),o("⚠️ API недоступен");return}let s=null;try{s=await chrome.runtime.sendMessage({action:"getApiSettings"})}catch(r){console.warn("Error sending message to background:",r),b("http://130.61.200.70:8080");return}if(s&&s.settings&&s.settings.apiUrl){const r=s.settings.apiUrl;b(r)}else b("http://130.61.200.70:8080")}catch(s){console.error("Error loading API settings:",s),b("http://130.61.200.70:8080")}},b=async function(s){o("⏳ Проверка соединения...");try{(await fetch(`${s}/api/health`,{method:"GET",headers:{"Content-Type":"application/json"}})).ok?o("Соединение установлено"):o("⚠️ Сервер недоступен")}catch{o("❌ Не удалось подключиться к серверу")}};return e.jsxs("div",{className:"w-full h-full bg-slate-50/50 flex flex-col font-sans text-slate-800",children:[e.jsxs("header",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm border-b border-slate-200 px-5 py-4 shadow-sm",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900 leading-tight",children:"LMS MAI Quiz Solver"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium",children:"Автоматический помощник для решения тестов"})]}),e.jsxs("main",{className:"flex-1 overflow-y-auto px-5 py-6 space-y-8 scroll-smooth",children:[e.jsx(h,{title:"Как использовать",icon:U,children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{number:1,title:"Откройте тест в Moodle"}),e.jsx(i,{number:2,title:"Нажмите «Найти ответ»",description:"Кнопка появится под каждым вопросом",icon:v,highlight:!0}),e.jsx(i,{number:3,title:"Автоматическое решение",description:"Расширение автоматически найдет и применит правильный ответ"}),e.jsx(i,{number:4,title:"Авто-решение",description:"Используйте для всех вопросов сразу",icon:E}),e.jsx(i,{number:5,title:"Автоматическое сканирование",description:"Расширение автоматически сканирует все пройденные тесты при взаимодействии с сайтом",icon:g,highlight:!0})]})}),e.jsx(h,{title:"Возможности",icon:A,children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(v,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"Автоматический поиск правильных ответов"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(H,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:"Умный анализ вопросов и вариантов"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(E,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{children:"Массовое решение всех вопросов"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(N,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Поиск ответов в Google для сложных вопросов"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(g,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Автоматическое сканирование всех пройденных тестов"})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-700 bg-white p-2.5 rounded-lg border border-slate-100 shadow-sm transition-transform hover:scale-[1.01]",children:[e.jsx(P,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"Автоматическое сохранение ответов при прохождении тестов"})]})]})}),e.jsx(h,{title:"Методы поиска ответов",icon:w,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{number:1,title:"Сохраненные ответы",description:"Использует ранее сохраненные правильные ответы"}),e.jsx(i,{number:2,title:"Статистика других пользователей",description:"Показывает наиболее популярные правильные ответы",icon:Z}),e.jsx(i,{number:3,title:"Поиск на странице",description:"Ищет уже отмеченные правильные ответы",icon:q}),e.jsx(i,{number:4,title:"Онлайн поиск",description:"Открывает Google для поиска ответа, если ответ не найден в базе",icon:N})]})}),e.jsx(h,{title:"Статистика",icon:v,children:e.jsx(D,{saved:t.saved,total:t.total,attempts:t.attempts})}),e.jsx(h,{title:"Синхронизация между пользователями",icon:N,children:e.jsx("div",{className:"bg-emerald-50 border border-emerald-100 rounded-lg p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-emerald-800",children:[e.jsx(M,{className:"w-4 h-4 text-emerald-600"}),"Синхронизация включена"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-emerald-800",children:[e.jsx(M,{className:"w-4 h-4 text-emerald-600"}),c]})]})})}),e.jsx(h,{title:"Сохраненные данные",icon:w,children:e.jsx("div",{className:"space-y-2",children:e.jsxs("button",{onClick:()=>{chrome.tabs.create({url:chrome.runtime.getURL("html/saved-data-react.html")})},className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all flex items-center justify-center gap-2 shadow-md",children:[e.jsx(w,{className:"w-4 h-4"}),"Просмотр данных"]})})}),e.jsx(h,{title:"Автосканирование",icon:g,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-3 mb-2",children:e.jsx("p",{className:"text-sm text-blue-800",children:"Расширение автоматически сканирует все пройденные тесты при открытии главной страницы LMS или любой другой страницы сайта. Сканирование происходит в фоновом режиме без открытия новых вкладок."})}),e.jsxs("button",{onClick:()=>{chrome.tabs.create({url:chrome.runtime.getURL("html/auto-scan-react.html")})},className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all flex items-center justify-center gap-2 shadow-md",children:[e.jsx(g,{className:"w-4 h-4"}),"Ручное автосканирование"]})]})})]}),e.jsx("footer",{className:"bg-amber-50 border-t border-amber-100 p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs text-amber-900 leading-relaxed",children:[e.jsx("span",{className:"font-bold",children:"Совет:"})," Сохраняйте правильные ответы с помощью кнопки ",e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-amber-100 rounded text-amber-800 font-semibold border border-amber-200",children:[e.jsx(B,{className:"w-3 h-3"})," Сохранить ответ"]})," — это поможет другим пользователям и вам в будущем."]}),e.jsxs("p",{className:"text-xs text-amber-900 leading-relaxed",children:[e.jsx("span",{className:"font-bold",children:"Автосканирование:"})," Расширение автоматически сканирует все пройденные тесты при открытии страниц LMS. Ответы сохраняются автоматически при прохождении тестов."]}),e.jsx("p",{className:"text-xs text-amber-900 leading-relaxed",children:"Включите синхронизацию с сервером для обмена статистикой между всеми пользователями."})]})]})})]})};typeof window<"u"&&(window.addEventListener("error",t=>{console.error("[Global Error Handler]",t.error||t.message,t.filename,t.lineno),t.preventDefault()}),window.addEventListener("unhandledrejection",t=>{console.error("[Unhandled Promise Rejection]",t.reason),t.preventDefault()}));function C(){try{const t=document.getElementById("root");if(!t){console.error("[Popup Init] Root container not found"),document.body.innerHTML='<div style="padding: 20px; color: red; font-family: Arial;">Ошибка: контейнер root не найден</div>';return}console.log("[Popup Init] Starting React app..."),I(t).render(e.jsx(R.StrictMode,{children:e.jsx(G,{})})),console.log("[Popup Init] React app rendered successfully")}catch(t){console.error("[Popup Init Error]",t);const a=document.getElementById("root");a&&(a.innerHTML=`
        <div style="padding: 20px; color: red; font-family: Arial;">
          <h2>Ошибка загрузки расширения</h2>
          <p>Проверьте консоль для деталей.</p>
          <pre style="background: #f5f5f5; padding: 10px; margin-top: 10px; overflow: auto;">${t instanceof Error?t.stack:String(t)}</pre>
        </div>
      `)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",C):C();
//# sourceMappingURL=popup.js.map
